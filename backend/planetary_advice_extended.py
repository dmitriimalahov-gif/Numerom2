"""
–†–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Å–æ–≤–µ—Ç–æ–≤ —Å –≥–ª—É–±–æ–∫–∏–º –∞–Ω–∞–ª–∏–∑–æ–º
"""
from typing import Dict, Any, List
from datetime import datetime


def get_advanced_personalized_advice(
    planet: str,
    soul_num: int,
    destiny_num: int,
    mind_num: int,
    ruling_num: int,
    planet_count: int,
    birth_weekday: int,
    current_weekday: int,
    is_night: bool
) -> List[Dict[str, str]]:
    """
    –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –≥–ª—É–±–æ–∫–æ –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Å–æ–≤–µ—Ç—ã –Ω–∞ –æ—Å–Ω–æ–≤–µ –∫–æ–º–±–∏–Ω–∞—Ü–∏–π –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
    
    Returns:
        –°–ø–∏—Å–æ–∫ —Å–ª–æ–≤–∞—Ä–µ–π —Å –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–º–∏ –∑–∞–º–µ—Ç–∫–∞–º–∏
    """
    notes = []
    
    # === –ê–ù–ê–õ–ò–ó –†–ï–ó–û–ù–ê–ù–°–ê –ü–õ–ê–ù–ï–¢–´ –° –ß–ò–°–õ–ê–ú–ò ===
    
    # –ú–∞–ø–ø–∏–Ω–≥ –ø–ª–∞–Ω–µ—Ç –Ω–∞ –∏—Ö —á–∏—Å–ª–∞
    planet_numbers = {
        "Sun": 1,
        "Moon": 2,
        "Jupiter": 3,
        "Rahu": 4,
        "Mercury": 5,
        "Venus": 6,
        "Ketu": 7,
        "Saturn": 8,
        "Mars": 9
    }
    
    planet_num = planet_numbers.get(planet, 0)
    
    # 1. –ü–û–õ–ù–´–ô –†–ï–ó–û–ù–ê–ù–°: –ü–ª–∞–Ω–µ—Ç–∞ —Å–æ–≤–ø–∞–¥–∞–µ—Ç —Å —á–∏—Å–ª–æ–º –¥—É—à–∏
    if soul_num == planet_num:
        notes.append({
            "type": "perfect_resonance",
            "title": "üåü –ò–î–ï–ê–õ–¨–ù–´–ô –†–ï–ó–û–ù–ê–ù–°!",
            "advice": f"–í–∞—à–µ —á–∏—Å–ª–æ –¥—É—à–∏ ({soul_num}) –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ä–µ–∑–æ–Ω–∏—Ä—É–µ—Ç —Å {planet}! –≠—Ç–æ –í–ê–®–ï –≤—Ä–µ–º—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π —Å–∏–ª—ã. "
                     f"–í—Å–µ –Ω–∞—á–∏–Ω–∞–Ω–∏—è –≤ —ç—Ç–æ—Ç —á–∞—Å –±—É–¥—É—Ç –∏–º–µ—Ç—å –æ—Å–æ–±—É—é –ø–æ–¥–¥–µ—Ä–∂–∫—É —Å—É–¥—å–±—ã. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —ç—Ç–æ –≤—Ä–µ–º—è –¥–ª—è —Å–∞–º—ã—Ö "
                     f"–≤–∞–∂–Ω—ã—Ö –¥–µ–ª –≤ –≤–∞—à–µ–π –∂–∏–∑–Ω–∏. –ú–µ–¥–∏—Ç–∏—Ä—É–π—Ç–µ –Ω–∞ –º–∞–Ω—Ç—Ä—É {planet} –¥–ª—è —É—Å–∏–ª–µ–Ω–∏—è —ç—Ñ—Ñ–µ–∫—Ç–∞."
        })
    
    # 2. –†–ï–ó–û–ù–ê–ù–° –° –ß–ò–°–õ–û–ú –°–£–î–¨–ë–´
    if destiny_num == planet_num:
        notes.append({
            "type": "destiny_resonance",
            "title": "‚ú® –†–µ–∑–æ–Ω–∞–Ω—Å —Å —Å—É–¥—å–±–æ–π",
            "advice": f"–í–∞—à–µ —á–∏—Å–ª–æ —Å—É–¥—å–±—ã ({destiny_num}) —Å–æ–≤–ø–∞–¥–∞–µ—Ç —Å {planet}. –≠—Ç–æ –≤—Ä–µ–º—è –¥–ª—è —Ä–∞–±–æ—Ç—ã –Ω–∞–¥ –≤–∞—à–∏–º "
                     f"–∂–∏–∑–Ω–µ–Ω–Ω—ã–º –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ–º. –°—É–¥—å–±–∞ –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç –¥–≤–µ—Ä–∏ –≤ —ç—Ç–æ—Ç —á–∞—Å. –ü—Ä–∏–Ω–∏–º–∞–π—Ç–µ –≤–∞–∂–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è, "
                     f"–∫–æ—Ç–æ—Ä—ã–µ –ø–æ–≤–ª–∏—è—é—Ç –Ω–∞ –≤–∞—à–µ –±—É–¥—É—â–µ–µ."
        })
    
    # 3. –†–ï–ó–û–ù–ê–ù–° –° –ß–ò–°–õ–û–ú –£–ú–ê
    if mind_num == planet_num:
        notes.append({
            "type": "mind_resonance",
            "title": "üß† –Ø—Å–Ω–æ—Å—Ç—å —É–º–∞",
            "advice": f"–í–∞—à–µ —á–∏—Å–ª–æ —É–º–∞ ({mind_num}) —Ä–µ–∑–æ–Ω–∏—Ä—É–µ—Ç —Å {planet}. –í–∞—à —É–º —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ –ø–∏–∫–µ –≤ —ç—Ç–æ—Ç —á–∞—Å. "
                     f"–ò–¥–µ–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è –¥–ª—è –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç—É–∞–ª—å–Ω–æ–π —Ä–∞–±–æ—Ç—ã, –ø—Ä–∏–Ω—è—Ç–∏—è —Ä–µ—à–µ–Ω–∏–π –∏ –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è. "
                     f"–í–∞—à–∞ –∏–Ω—Ç—É–∏—Ü–∏—è –æ—Å–æ–±–µ–Ω–Ω–æ —Å–∏–ª—å–Ω–∞."
        })
    
    # 4. –†–ï–ó–û–ù–ê–ù–° –° –ü–†–ê–í–Ø–©–ò–ú –ß–ò–°–õ–û–ú
    if ruling_num == planet_num:
        notes.append({
            "type": "ruling_resonance",
            "title": "üëë –°–∏–ª–∞ –ø—Ä–∞–≤—è—â–µ–≥–æ —á–∏—Å–ª–∞",
            "advice": f"–í–∞—à–µ –ø—Ä–∞–≤—è—â–µ–µ —á–∏—Å–ª–æ ({ruling_num}) —É—Å–∏–ª–∏–≤–∞–µ—Ç—Å—è {planet}. –≠—Ç–æ –≤—Ä–µ–º—è –≤–∞—à–µ–π –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π "
                     f"–ª–∏—á–Ω–æ–π —Å–∏–ª—ã –∏ –≤–ª–∏—è–Ω–∏—è. –ü—Ä–æ—è–≤–ª—è–π—Ç–µ –ª–∏–¥–µ—Ä—Å—Ç–≤–æ, –±–µ—Ä–∏—Ç–µ –∏–Ω–∏—Ü–∏–∞—Ç–∏–≤—É –≤ —Å–≤–æ–∏ —Ä—É–∫–∏."
        })
    
    # === –ö–û–ú–ë–ò–ù–ò–†–û–í–ê–ù–ù–´–ô –ê–ù–ê–õ–ò–ó ===
    
    # 5. –î–£–®–ê + –°–£–î–¨–ë–ê —Å–æ–≤–ø–∞–¥–∞—é—Ç —Å –ø–ª–∞–Ω–µ—Ç–æ–π
    if soul_num == planet_num and destiny_num == planet_num:
        notes.append({
            "type": "soul_destiny_match",
            "title": "üí´ –î–í–û–ô–ù–û–ô –†–ï–ó–û–ù–ê–ù–°: –î—É—à–∞ –∏ –°—É–¥—å–±–∞",
            "advice": "–ù–µ–≤–µ—Ä–æ—è—Ç–Ω–æ —Ä–µ–¥–∫–æ–µ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ! –í–∞—à–∞ –¥—É—à–∞ –∏ —Å—É–¥—å–±–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ä–µ–∑–æ–Ω–∏—Ä—É—é—Ç —Å —ç—Ç–æ–π –ø–ª–∞–Ω–µ—Ç–æ–π. "
                     "–≠—Ç–æ –≤–∞—à –ì–õ–ê–í–ù–´–ô –ø–ª–∞–Ω–µ—Ç–∞—Ä–Ω—ã–π —á–∞—Å. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –µ–≥–æ –¥–ª—è —Å–∞–º—ã—Ö —Å—É–¥—å–±–æ–Ω–æ—Å–Ω—ã—Ö —Ä–µ—à–µ–Ω–∏–π. "
                     "–ü–æ–≤—Ç–æ—Ä—è–π—Ç–µ –º–∞–Ω—Ç—Ä—É –ø–ª–∞–Ω–µ—Ç—ã 108 —Ä–∞–∑ –¥–ª—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–≥–æ —ç—Ñ—Ñ–µ–∫—Ç–∞."
        })
    
    # 6. –£–ú + –î–£–®–ê —Å–æ–≤–ø–∞–¥–∞—é—Ç
    if soul_num == planet_num and mind_num == planet_num:
        notes.append({
            "type": "soul_mind_match",
            "title": "üéØ –ï–¥–∏–Ω—Å—Ç–≤–æ –¥—É—à–∏ –∏ —É–º–∞",
            "advice": "–í–∞—à–∞ –¥—É—à–∞ –∏ —É–º –≤ –ø–æ–ª–Ω–æ–π –≥–∞—Ä–º–æ–Ω–∏–∏ —Å —ç—Ç–æ–π –ø–ª–∞–Ω–µ—Ç–æ–π. –°–ª–µ–¥—É–π—Ç–µ —Å–≤–æ–µ–π –∏–Ω—Ç—É–∏—Ü–∏–∏ - "
                     "–æ–Ω–∞ –Ω–µ –ø–æ–¥–≤–µ–¥–µ—Ç. –í–∞—à–∏ –∂–µ–ª–∞–Ω–∏—è –∏ –º—ã—Å–ª–∏ —Å–æ–≤–ø–∞–¥–∞—é—Ç, —á—Ç–æ –¥–∞–µ—Ç –æ–≥—Ä–æ–º–Ω—É—é —Å–∏–ª—É –¥–ª—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏."
        })
    
    # === –ê–ù–ê–õ–ò–ó –°–ò–õ–´ –ü–õ–ê–ù–ï–¢–´ –í –ö–í–ê–î–†–ê–¢–ï –ü–ò–§–ê–ì–û–†–ê ===
    
    # 7. –ö–†–ò–¢–ò–ß–ï–°–ö–ò –°–õ–ê–ë–ê–Ø –ü–õ–ê–ù–ï–¢–ê (0 —Ü–∏—Ñ—Ä)
    if planet_count == 0:
        notes.append({
            "type": "critical_weakness",
            "title": "‚ö†Ô∏è –ö–†–ò–¢–ò–ß–ï–°–ö–ê–Ø –°–õ–ê–ë–û–°–¢–¨",
            "advice": f"–£ –≤–∞—Å –ü–û–õ–ù–û–°–¢–¨–Æ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç —ç–Ω–µ—Ä–≥–∏—è {planet} –≤ –∫–≤–∞–¥—Ä–∞—Ç–µ –ü–∏—Ñ–∞–≥–æ—Ä–∞! –≠—Ç–æ –≤–∞—à–∞ —Å–∞–º–∞—è —Å–ª–∞–±–∞—è "
                     f"–ø–ª–∞–Ω–µ—Ç–∞. –≠—Ç–æ—Ç —á–∞—Å –ö–†–ò–¢–ò–ß–ï–°–ö–ò –≤–∞–∂–µ–Ω –¥–ª—è –≤–∞—Å - –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –µ–≥–æ –¥–ª—è –∫–æ–º–ø–µ–Ω—Å–∞—Ü–∏–∏ –Ω–µ–¥–æ—Å—Ç–∞—Ç–∫–∞. "
                     f"–ü–æ–≤—Ç–æ—Ä—è–π—Ç–µ –º–∞–Ω—Ç—Ä—É {planet} –µ–∂–µ–¥–Ω–µ–≤–Ω–æ. –†–∞–±–æ—Ç–∞–π—Ç–µ –Ω–∞–¥ –∫–∞—á–µ—Å—Ç–≤–∞–º–∏ —ç—Ç–æ–π –ø–ª–∞–Ω–µ—Ç—ã. "
                     f"–ù–æ—Å–∏—Ç–µ –∫–∞–º–Ω–∏ –∏ —Ü–≤–µ—Ç–∞, —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ {planet}."
        })
    
    # 8. –û–ß–ï–ù–¨ –°–õ–ê–ë–ê–Ø –ü–õ–ê–ù–ï–¢–ê (1 —Ü–∏—Ñ—Ä–∞)
    elif planet_count == 1:
        notes.append({
            "type": "severe_weakness",
            "title": "‚ö° –°–ª–∞–±–∞—è –ø–ª–∞–Ω–µ—Ç–∞ - —Ä–∞–±–æ—Ç–∞–π—Ç–µ —É—Å–∏–ª–µ–Ω–Ω–æ",
            "advice": f"–£ –≤–∞—Å –æ—á–µ–Ω—å —Å–ª–∞–±–∞—è —ç–Ω–µ—Ä–≥–∏—è {planet} (–≤—Å–µ–≥–æ 1 —Ü–∏—Ñ—Ä–∞). –≠—Ç–æ—Ç —á–∞—Å - –≤–∞—à —à–∞–Ω—Å —É—Å–∏–ª–∏—Ç—å —ç—Ç—É "
                     f"—ç–Ω–µ—Ä–≥–∏—é. –°–æ–∑–Ω–∞—Ç–µ–ª—å–Ω–æ —Ä–∞–∑–≤–∏–≤–∞–π—Ç–µ –∫–∞—á–µ—Å—Ç–≤–∞ {planet}. –ú–µ–¥–∏—Ç–∏—Ä—É–π—Ç–µ –Ω–∞ –ø–ª–∞–Ω–µ—Ç—É, "
                     f"–ø–æ–≤—Ç–æ—Ä—è–π—Ç–µ –º–∞–Ω—Ç—Ä—É, –∏–∑—É—á–∞–π—Ç–µ –µ–µ –≤–ª–∏—è–Ω–∏–µ –≤ –≤–∞—à–µ–π –∂–∏–∑–Ω–∏."
        })
    
    # 9. –ò–ó–ë–´–¢–û–ß–ù–ê–Ø –°–ò–õ–ê (5+ —Ü–∏—Ñ—Ä)
    elif planet_count >= 5:
        notes.append({
            "type": "excessive_strength",
            "title": "üí™ –ò–ó–ë–´–¢–û–ß–ù–ê–Ø –°–ò–õ–ê - –ö–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–π—Ç–µ!",
            "advice": f"–£ –≤–∞—Å –û–ß–ï–ù–¨ —Å–∏–ª—å–Ω–∞—è —ç–Ω–µ—Ä–≥–∏—è {planet} ({planet_count} —Ü–∏—Ñ—Ä)! –≠—Ç–æ –º–æ–∂–µ—Ç –±—ã—Ç—å –∫–∞–∫ –±–ª–∞–≥–æ–º, "
                     f"—Ç–∞–∫ –∏ –ø—Ä–æ–±–ª–µ–º–æ–π. –í —ç—Ç–æ—Ç —á–∞—Å –≤–∞—à–∞ —ç–Ω–µ—Ä–≥–∏—è –ø–ª–∞–Ω–µ—Ç—ã –Ω–∞ –ø–∏–∫–µ - –±—É–¥—å—Ç–µ –æ—Å—Ç–æ—Ä–æ–∂–Ω—ã —Å –ø–µ—Ä–µ–±–æ—Ä–æ–º. "
                     f"–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å–∏–ª—É –º—É–¥—Ä–æ, –Ω–µ –¥–∞–≤–∏—Ç–µ –Ω–∞ –¥—Ä—É–≥–∏—Ö, –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–π—Ç–µ –ø—Ä–æ—è–≤–ª–µ–Ω–∏—è –ø–ª–∞–Ω–µ—Ç—ã."
        })
    
    # 10. –ì–ê–†–ú–û–ù–ò–ß–ù–ê–Ø –°–ò–õ–ê (2-4 —Ü–∏—Ñ—Ä—ã)
    elif 2 <= planet_count <= 4:
        notes.append({
            "type": "balanced_strength",
            "title": "‚öñÔ∏è –ì–∞—Ä–º–æ–Ω–∏—á–Ω–∞—è —ç–Ω–µ—Ä–≥–∏—è",
            "advice": f"–£ –≤–∞—Å —Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —ç–Ω–µ—Ä–≥–∏—è {planet} ({planet_count} —Ü–∏—Ñ—Ä—ã). –≠—Ç–æ—Ç —á–∞—Å —É—Å–∏–ª–∏—Ç –≤–∞—à–∏ "
                     f"–µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏. –î–µ–π—Å—Ç–≤—É–π—Ç–µ —É–≤–µ—Ä–µ–Ω–Ω–æ, –æ–ø–∏—Ä–∞—è—Å—å –Ω–∞ —Å–≤–æ–∏ —Å–∏–ª—å–Ω—ã–µ —Å—Ç–æ—Ä–æ–Ω—ã."
        })
    
    # === –ê–ù–ê–õ–ò–ó –î–ù–Ø –ù–ï–î–ï–õ–ò ===
    
    # –ú–∞–ø–ø–∏–Ω–≥ –¥–Ω–µ–π –Ω–µ–¥–µ–ª–∏ –Ω–∞ –ø–ª–∞–Ω–µ—Ç—ã
    weekday_planets = {
        0: "Moon",      # –ü–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫
        1: "Mars",      # –í—Ç–æ—Ä–Ω–∏–∫
        2: "Mercury",   # –°—Ä–µ–¥–∞
        3: "Jupiter",   # –ß–µ—Ç–≤–µ—Ä–≥
        4: "Venus",     # –ü—è—Ç–Ω–∏—Ü–∞
        5: "Saturn",    # –°—É–±–±–æ—Ç–∞
        6: "Sun"        # –í–æ—Å–∫—Ä–µ—Å–µ–Ω—å–µ
    }
    
    # 11. –î–ï–ù–¨ –ù–ï–î–ï–õ–ò –†–û–ñ–î–ï–ù–ò–Ø = –°–ï–ì–û–î–ù–Ø
    if birth_weekday == current_weekday:
        notes.append({
            "type": "birth_weekday_today",
            "title": "üéÇ –í–∞—à –¥–µ–Ω—å –Ω–µ–¥–µ–ª–∏ —Ä–æ–∂–¥–µ–Ω–∏—è!",
            "advice": f"–°–µ–≥–æ–¥–Ω—è –¥–µ–Ω—å –Ω–µ–¥–µ–ª–∏, –≤ –∫–æ—Ç–æ—Ä—ã–π –≤—ã —Ä–æ–¥–∏–ª–∏—Å—å! –í—Å–µ –ø–ª–∞–Ω–µ—Ç–∞—Ä–Ω—ã–µ —á–∞—Å—ã —Å–µ–≥–æ–¥–Ω—è –æ—Å–æ–±–µ–Ω–Ω–æ —Å–∏–ª—å–Ω—ã "
                     f"–¥–ª—è –≤–∞—Å. –≠–Ω–µ—Ä–≥–∏—è {planet} –≤ —ç—Ç–æ—Ç —á–∞—Å —É—Å–∏–ª–µ–Ω–∞ –≤–¥–≤–æ–π–Ω–µ. –≠—Ç–æ –≤–∞—à –ª–∏—á–Ω—ã–π –¥–µ–Ω—å —Å–∏–ª—ã!"
        })
    
    # 12. –ü–õ–ê–ù–ï–¢–ê –î–ù–Ø –°–û–í–ü–ê–î–ê–ï–¢ –° –ü–õ–ê–ù–ï–¢–û–ô –ß–ê–°–ê
    if weekday_planets.get(current_weekday) == planet:
        notes.append({
            "type": "planet_day_match",
            "title": "üìÖ –î–µ–Ω—å –ø–ª–∞–Ω–µ—Ç—ã!",
            "advice": f"–°–µ–≥–æ–¥–Ω—è –¥–µ–Ω—å {planet}! –ü–ª–∞–Ω–µ—Ç–∞ —É–ø—Ä–∞–≤–ª—è–µ—Ç –∏ –¥–Ω–µ–º, –∏ —ç—Ç–∏–º —á–∞—Å–æ–º. –î–≤–æ–π–Ω–∞—è —Å–∏–ª–∞! "
                     f"–í—Å–µ –¥–µ–ª–∞, —Å–≤—è–∑–∞–Ω–Ω—ã–µ —Å {planet}, –±—É–¥—É—Ç –æ—Å–æ–±–µ–Ω–Ω–æ —É—Å–ø–µ—à–Ω—ã."
        })
    
    # 13. –ü–õ–ê–ù–ï–¢–ê –î–ù–Ø –†–û–ñ–î–ï–ù–ò–Ø –°–û–í–ü–ê–î–ê–ï–¢ –° –ü–õ–ê–ù–ï–¢–û–ô –ß–ê–°–ê
    if weekday_planets.get(birth_weekday) == planet:
        notes.append({
            "type": "birth_planet_match",
            "title": "üå† –ü–ª–∞–Ω–µ—Ç–∞ –≤–∞—à–µ–≥–æ —Ä–æ–∂–¥–µ–Ω–∏—è",
            "advice": f"–í—ã —Ä–æ–¥–∏–ª–∏—Å—å –≤ –¥–µ–Ω—å {planet}! –≠—Ç–∞ –ø–ª–∞–Ω–µ—Ç–∞ - –≤–∞—à –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω—ã–π –ø–æ–∫—Ä–æ–≤–∏—Ç–µ–ª—å. "
                     f"–ß–∞—Å {planet} –≤—Å–µ–≥–¥–∞ –±–ª–∞–≥–æ–ø—Ä–∏—è—Ç–µ–Ω –¥–ª—è –≤–∞—Å. –†–∞–∑–≤–∏–≤–∞–π—Ç–µ –æ—Ç–Ω–æ—à–µ–Ω–∏—è —Å —ç—Ç–æ–π –ø–ª–∞–Ω–µ—Ç–æ–π."
        })
    
    # === –ö–û–ú–ë–ò–ù–ò–†–û–í–ê–ù–ù–´–ô –ê–ù–ê–õ–ò–ó –ß–ò–°–ï–õ ===
    
    # 14. –í–°–ï –ß–ò–°–õ–ê –ß–ï–¢–ù–´–ï –∏–ª–∏ –í–°–ï –ù–ï–ß–ï–¢–ù–´–ï
    all_numbers = [n for n in [soul_num, destiny_num, mind_num, ruling_num] if n]
    if all_numbers:
        all_even = all(n % 2 == 0 for n in all_numbers)
        all_odd = all(n % 2 == 1 for n in all_numbers)
        
        if all_even and planet_num % 2 == 0:
            notes.append({
                "type": "even_harmony",
                "title": "‚ö™ –ì–∞—Ä–º–æ–Ω–∏—è —á–µ—Ç–Ω—ã—Ö —á–∏—Å–µ–ª",
                "advice": "–í—Å–µ –≤–∞—à–∏ —á–∏—Å–ª–∞ —á–µ—Ç–Ω—ã–µ, –∏ –ø–ª–∞–Ω–µ—Ç–∞ —Ç–æ–∂–µ —á–µ—Ç–Ω–∞—è! –í—ã —á–µ–ª–æ–≤–µ–∫ —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏ –∏ –≥–∞—Ä–º–æ–Ω–∏–∏. "
                         "–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —ç—Ç–æ—Ç —á–∞—Å –¥–ª—è —É–∫—Ä–µ–ø–ª–µ–Ω–∏—è –æ—Å–Ω–æ–≤, —Ä–∞–±–æ—Ç—ã —Å –º–∞—Ç–µ—Ä–∏–∞–ª—å–Ω—ã–º –º–∏—Ä–æ–º."
            })
        elif all_odd and planet_num % 2 == 1:
            notes.append({
                "type": "odd_harmony",
                "title": "‚ö´ –°–∏–ª–∞ –Ω–µ—á–µ—Ç–Ω—ã—Ö —á–∏—Å–µ–ª",
                "advice": "–í—Å–µ –≤–∞—à–∏ —á–∏—Å–ª–∞ –Ω–µ—á–µ—Ç–Ω—ã–µ, –∏ –ø–ª–∞–Ω–µ—Ç–∞ —Ç–æ–∂–µ –Ω–µ—á–µ—Ç–Ω–∞—è! –í—ã —á–µ–ª–æ–≤–µ–∫ –¥–µ–π—Å—Ç–≤–∏—è –∏ –ø–µ—Ä–µ–º–µ–Ω. "
                         "–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —ç—Ç–æ—Ç —á–∞—Å –¥–ª—è –∞–∫—Ç–∏–≤–Ω—ã—Ö –¥–µ–π—Å—Ç–≤–∏–π, –∏–Ω–∏—Ü–∏–∞—Ç–∏–≤—ã, –ª–∏–¥–µ—Ä—Å—Ç–≤–∞."
            })
    
    # 15. –°–£–ú–ú–ê –ß–ò–°–ï–õ –î–£–®–ò –ò –°–£–î–¨–ë–´
    if soul_num and destiny_num:
        sum_soul_destiny = soul_num + destiny_num
        if sum_soul_destiny == planet_num or (sum_soul_destiny > 9 and sum(int(d) for d in str(sum_soul_destiny)) == planet_num):
            notes.append({
                "type": "sum_resonance",
                "title": "üî¢ –ß–∏—Å–ª–æ–≤–æ–π —Ä–µ–∑–æ–Ω–∞–Ω—Å",
                "advice": f"–°—É–º–º–∞ –≤–∞—à–µ–≥–æ —á–∏—Å–ª–∞ –¥—É—à–∏ ({soul_num}) –∏ —Å—É–¥—å–±—ã ({destiny_num}) —Ä–µ–∑–æ–Ω–∏—Ä—É–µ—Ç —Å {planet}! "
                         f"–≠—Ç–æ —Å–∫—Ä—ã—Ç–∞—è —Å–≤—è–∑—å, –∫–æ—Ç–æ—Ä–∞—è —É—Å–∏–ª–∏–≤–∞–µ—Ç –≤–ª–∏—è–Ω–∏–µ –ø–ª–∞–Ω–µ—Ç—ã –Ω–∞ –≤–∞—à—É –∂–∏–∑–Ω—å."
            })
    
    # === –ê–ù–ê–õ–ò–ó –í–†–ï–ú–ï–ù–ò –°–£–¢–û–ö ===
    
    # 16. –ù–û–ß–ù–û–ô –ß–ê–° + –°–õ–ê–ë–ê–Ø –ü–õ–ê–ù–ï–¢–ê
    if is_night and planet_count <= 1:
        notes.append({
            "type": "night_weak_planet",
            "title": "üåô –ù–æ—á–Ω–∞—è —Ä–∞–±–æ—Ç–∞ —Å–æ —Å–ª–∞–±–æ—Å—Ç—å—é",
            "advice": "–ù–æ—á–Ω–æ–π —á–∞—Å —Å–ª–∞–±–æ–π –¥–ª—è –≤–∞—Å –ø–ª–∞–Ω–µ—Ç—ã - –≤—Ä–µ–º—è –≥–ª—É–±–æ–∫–æ–π –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–π —Ä–∞–±–æ—Ç—ã. "
                     "–ú–µ–¥–∏—Ç–∏—Ä—É–π—Ç–µ, —Ä–∞–±–æ—Ç–∞–π—Ç–µ —Å –ø–æ–¥—Å–æ–∑–Ω–∞–Ω–∏–µ–º, —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∏—Ä—É–π—Ç–µ —Å–ª–∞–±–æ—Å—Ç—å –≤ —Å–∏–ª—É. "
                     "–ù–æ—á—å –±–ª–∞–≥–æ–ø—Ä–∏—è—Ç–Ω–∞ –¥–ª—è –¥—É—Ö–æ–≤–Ω—ã—Ö –ø—Ä–∞–∫—Ç–∏–∫."
        })
    
    # 17. –î–ù–ï–í–ù–û–ô –ß–ê–° + –°–ò–õ–¨–ù–ê–Ø –ü–õ–ê–ù–ï–¢–ê
    if not is_night and planet_count >= 4:
        notes.append({
            "type": "day_strong_planet",
            "title": "‚òÄÔ∏è –î–Ω–µ–≤–Ω–∞—è —Å–∏–ª–∞",
            "advice": "–î–Ω–µ–≤–Ω–æ–π —á–∞—Å –≤–∞—à–µ–π —Å–∏–ª—å–Ω–æ–π –ø–ª–∞–Ω–µ—Ç—ã - –≤—Ä–µ–º—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –∏ –ø—Ä–æ—è–≤–ª–µ–Ω–∏—è! "
                     "–î–µ–π—Å—Ç–≤—É–π—Ç–µ –æ—Ç–∫—Ä—ã—Ç–æ, –ø—Ä–æ—è–≤–ª—è–π—Ç–µ —Å–≤–æ–∏ —Ç–∞–ª–∞–Ω—Ç—ã, —Ä–µ–∞–ª–∏–∑—É–π—Ç–µ –ø–ª–∞–Ω—ã. "
                     "–í–∞—à–∞ —ç–Ω–µ—Ä–≥–∏—è –Ω–∞ –ø–∏–∫–µ!"
        })
    
    # === –°–ü–ï–¶–ò–ê–õ–¨–ù–´–ï –ö–û–ú–ë–ò–ù–ê–¶–ò–ò ===
    
    # 18. –ß–ò–°–õ–û –î–£–®–ò = –ß–ò–°–õ–û –£–ú–ê (–≤–Ω—É—Ç—Ä–µ–Ω–Ω—è—è –≥–∞—Ä–º–æ–Ω–∏—è)
    if soul_num and mind_num and soul_num == mind_num:
        notes.append({
            "type": "soul_mind_unity",
            "title": "üé≠ –ï–¥–∏–Ω—Å—Ç–≤–æ –¥—É—à–∏ –∏ —É–º–∞",
            "advice": f"–í–∞—à–µ —á–∏—Å–ª–æ –¥—É—à–∏ –∏ —É–º–∞ —Å–æ–≤–ø–∞–¥–∞—é—Ç ({soul_num})! –í—ã —Ü–µ–ª–æ—Å—Ç–Ω–∞—è –ª–∏—á–Ω–æ—Å—Ç—å. "
                     f"–í —á–∞—Å {planet} —ç—Ç–∞ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç—å —É—Å–∏–ª–∏–≤–∞–µ—Ç—Å—è. –°–ª–µ–¥—É–π—Ç–µ —Å–≤–æ–µ–º—É –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–º—É –≥–æ–ª–æ—Å—É."
        })
    
    # 19. –ß–ò–°–õ–û –î–£–®–ò = –ß–ò–°–õ–û –°–£–î–¨–ë–´ (—Å—É–¥—å–±–æ–Ω–æ—Å–Ω–æ—Å—Ç—å)
    if soul_num and destiny_num and soul_num == destiny_num:
        notes.append({
            "type": "soul_destiny_unity",
            "title": "üåü –°—É–¥—å–±–æ–Ω–æ—Å–Ω–∞—è –ª–∏—á–Ω–æ—Å—Ç—å",
            "advice": f"–í–∞—à–µ —á–∏—Å–ª–æ –¥—É—à–∏ –∏ —Å—É–¥—å–±—ã —Å–æ–≤–ø–∞–¥–∞—é—Ç ({soul_num})! –í—ã –ø—Ä–∏—à–ª–∏ –≤ —ç—Ç–æ—Ç –º–∏—Ä —Å —è—Å–Ω–æ–π —Ü–µ–ª—å—é. "
                     f"–ß–∞—Å {planet} –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –≤–∞—à—É –º–∏—Å—Å–∏—é. –î–µ–π—Å—Ç–≤—É–π—Ç–µ –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ–º."
        })
    
    # 20. –ö–û–ù–§–õ–ò–ö–¢ –ß–ò–°–ï–õ (–¥—É—à–∞ –∏ —Å—É–¥—å–±–∞ –ø—Ä–æ—Ç–∏–≤–æ–ø–æ–ª–æ–∂–Ω—ã)
    if soul_num and destiny_num:
        # –ü—Ä–æ—Ç–∏–≤–æ–ø–æ–ª–æ–∂–Ω—ã–µ –ø–∞—Ä—ã: 1-8, 2-7, 3-6, 4-5
        opposites = [(1, 8), (8, 1), (2, 7), (7, 2), (3, 6), (6, 3), (4, 5), (5, 4)]
        if (soul_num, destiny_num) in opposites:
            notes.append({
                "type": "number_conflict",
                "title": "‚ö° –í–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π –∫–æ–Ω—Ñ–ª–∏–∫—Ç",
                "advice": f"–í–∞—à–µ —á–∏—Å–ª–æ –¥—É—à–∏ ({soul_num}) –∏ —Å—É–¥—å–±—ã ({destiny_num}) –ø—Ä–æ—Ç–∏–≤–æ–ø–æ–ª–æ–∂–Ω—ã. "
                         f"–ß–∞—Å {planet} –º–æ–∂–µ—Ç –ø–æ–º–æ—á—å –≥–∞—Ä–º–æ–Ω–∏–∑–∏—Ä–æ–≤–∞—Ç—å —ç—Ç–æ—Ç –∫–æ–Ω—Ñ–ª–∏–∫—Ç. –ò—â–∏—Ç–µ –±–∞–ª–∞–Ω—Å –º–µ–∂–¥—É "
                         f"–∂–µ–ª–∞–Ω–∏—è–º–∏ –¥—É—à–∏ –∏ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º–∏ —Å—É–¥—å–±—ã."
            })
    
    # === –ê–ù–ê–õ–ò–ó –ö–ê–†–ú–ò–ß–ï–°–ö–ò–• –°–í–Ø–ó–ï–ô ===
    
    # 21. –ö–ê–†–ú–ò–ß–ï–°–ö–ò–ï –ß–ò–°–õ–ê (13, 14, 16, 19)
    if soul_num and destiny_num:
        birth_day = soul_num  # –£–ø—Ä–æ—â–µ–Ω–∏–µ, –≤ —Ä–µ–∞–ª—å–Ω–æ—Å—Ç–∏ –Ω—É–∂–Ω–∞ –ø–æ–ª–Ω–∞—è –¥–∞—Ç–∞
        karmic_numbers = {
            13: "–¢—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏—è —á–µ—Ä–µ–∑ —Ç—Ä—É–¥",
            14: "–ü—Ä–µ–æ–¥–æ–ª–µ–Ω–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π",
            16: "–†–∞–∑—Ä—É—à–µ–Ω–∏–µ —ç–≥–æ",
            19: "–ù–µ–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –∏ –ª–∏–¥–µ—Ä—Å—Ç–≤–æ"
        }
        
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º –∫–∞—Ä–º–∏—á–µ—Å–∫–∏–µ —á–∏—Å–ª–∞
        for karmic_num, meaning in karmic_numbers.items():
            if birth_day == karmic_num or destiny_num == karmic_num:
                notes.append({
                    "type": "karmic_number",
                    "title": f"üîÆ –ö–∞—Ä–º–∏—á–µ—Å–∫–æ–µ —á–∏—Å–ª–æ {karmic_num}",
                    "advice": f"–£ –≤–∞—Å –∫–∞—Ä–º–∏—á–µ—Å–∫–æ–µ —á–∏—Å–ª–æ {karmic_num} ({meaning}). "
                             f"–ß–∞—Å {planet} –ø–æ–º–æ–≥–∞–µ—Ç –ø—Ä–æ—Ä–∞–±–æ—Ç–∞—Ç—å –∫–∞—Ä–º–∏—á–µ—Å–∫–∏–µ —É—Ä–æ–∫–∏. "
                             f"–ë—É–¥—å—Ç–µ –≤–Ω–∏–º–∞—Ç–µ–ª—å–Ω—ã –∫ –∑–Ω–∞–∫–∞–º —Å—É–¥—å–±—ã."
                })
    
    # 22. –ú–ê–°–¢–ï–†-–ß–ò–°–õ–ê (11, 22, 33)
    if ruling_num in [11, 22, 33]:
        notes.append({
            "type": "master_number",
            "title": f"‚ú® –ú–∞—Å—Ç–µ—Ä-—á–∏—Å–ª–æ {ruling_num}",
            "advice": f"–£ –≤–∞—Å –º–∞—Å—Ç–µ—Ä-—á–∏—Å–ª–æ {ruling_num}! –í—ã –ø—Ä–∏—à–ª–∏ —Å –æ—Å–æ–±–æ–π –º–∏—Å—Å–∏–µ–π. "
                     f"–ß–∞—Å {planet} —É—Å–∏–ª–∏–≤–∞–µ—Ç –≤–∞—à—É –¥—É—Ö–æ–≤–Ω—É—é —Å–∏–ª—É. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –¥–ª—è —Å–ª—É–∂–µ–Ω–∏—è –≤—ã—Å—à–∏–º —Ü–µ–ª—è–º."
        })
    
    return notes


def get_compatibility_advice(planet: str, soul_num: int, destiny_num: int) -> str:
    """
    –ê–Ω–∞–ª–∏–∑ —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏ –ø–ª–∞–Ω–µ—Ç—ã —Å —á–∏—Å–ª–∞–º–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    """
    # –î—Ä—É–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –ø–ª–∞–Ω–µ—Ç—ã
    planet_friends = {
        "Sun": ["Moon", "Mars", "Jupiter"],
        "Moon": ["Sun", "Mercury"],
        "Mars": ["Sun", "Moon", "Jupiter"],
        "Mercury": ["Sun", "Venus"],
        "Jupiter": ["Sun", "Moon", "Mars"],
        "Venus": ["Mercury", "Saturn"],
        "Saturn": ["Mercury", "Venus"],
        "Rahu": ["Mercury", "Venus", "Saturn"],
        "Ketu": ["Mars", "Jupiter"]
    }
    
    # –í—Ä–∞–∂–¥–µ–±–Ω—ã–µ –ø–ª–∞–Ω–µ—Ç—ã
    planet_enemies = {
        "Sun": ["Venus", "Saturn"],
        "Moon": ["Rahu", "Ketu"],
        "Mars": ["Mercury"],
        "Mercury": ["Moon"],
        "Jupiter": ["Mercury", "Venus"],
        "Venus": ["Sun", "Moon"],
        "Saturn": ["Sun", "Moon", "Mars"],
        "Rahu": ["Sun", "Moon"],
        "Ketu": ["Sun", "Moon"]
    }
    
    # –ú–∞–ø–ø–∏–Ω–≥ —á–∏—Å–µ–ª –Ω–∞ –ø–ª–∞–Ω–µ—Ç—ã
    number_to_planet = {
        1: "Sun", 2: "Moon", 3: "Jupiter", 4: "Rahu", 5: "Mercury",
        6: "Venus", 7: "Ketu", 8: "Saturn", 9: "Mars"
    }
    
    soul_planet = number_to_planet.get(soul_num)
    destiny_planet = number_to_planet.get(destiny_num)
    
    advice_parts = []
    
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º –¥—Ä—É–∂–±—É —Å –ø–ª–∞–Ω–µ—Ç–æ–π –¥—É—à–∏
    if soul_planet:
        if soul_planet in planet_friends.get(planet, []):
            advice_parts.append(f"‚úì {planet} –¥—Ä—É–∂–µ—Å—Ç–≤–µ–Ω–Ω–∞ –≤–∞—à–µ–π –¥—É—à–µ ({soul_planet})")
        elif soul_planet in planet_enemies.get(planet, []):
            advice_parts.append(f"‚ö† {planet} –≤—Ä–∞–∂–¥–µ–±–Ω–∞ –≤–∞—à–µ–π –¥—É—à–µ ({soul_planet}) - –±—É–¥—å—Ç–µ –æ—Å—Ç–æ—Ä–æ–∂–Ω—ã")
    
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º –¥—Ä—É–∂–±—É —Å –ø–ª–∞–Ω–µ—Ç–æ–π —Å—É–¥—å–±—ã
    if destiny_planet:
        if destiny_planet in planet_friends.get(planet, []):
            advice_parts.append(f"‚úì {planet} –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –≤–∞—à—É —Å—É–¥—å–±—É ({destiny_planet})")
        elif destiny_planet in planet_enemies.get(planet, []):
            advice_parts.append(f"‚ö† {planet} —Å–æ–∑–¥–∞–µ—Ç –ø—Ä–µ–ø—è—Ç—Å—Ç–≤–∏—è —Å—É–¥—å–±–µ ({destiny_planet})")
    
    return " | ".join(advice_parts) if advice_parts else ""

